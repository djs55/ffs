#!/usr/bin/env python

import sys

import xapi
import xapi.d

import argparse, json

class Implementation(xapi.d.Datapath_skeleton):
    def detach(self, dbg, uri, domain):
        return

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description='Disable I/O on a local datapath')
    parser.add_argument('-j', '--json', action='store_const', const=True, default=False, help='Read json from stdin, print json to stdout', required=False)
    args = vars(parser.parse_args())

    if not(args['json']):
        print "Not implemented"
        sys.exit(1)

    try:
        dispatcher = xapi.d.Datapath_server_dispatcher(Implementation())
        request = json.loads(sys.stdin.readline(),)
        results = dispatcher.detach(request)
        print json.dumps(results)
    except Exception, e:
        handle_exception(e)
